doctype html(lang='en')

mixin card_img(suit, card)
    - var classes = [suit.long.toLowerCase(), card.long.toLowerCase()];
    img(src='images/Cards/#{suit.long}/#{card.short}#{suit.short}.svg', class=classes)&attributes(attributes)


//- Creates a player circle, if the player number is 1 it will make it blue
mixin player_space(playerNo)
    - console.log(show_modal_attributes(playerNo, 2));
    .player(id='p' + playerNo tabIndex=playerNo)
        .no-cards(class = (playerNo === 1 ? 'enabled' : 'button'))&attributes(show_modal_attributes(playerNo, 2))
            .plus-content: span.glyphicon.glyphicon-plus

        ul.selected.table-card-set&attributes(show_modal_attributes(playerNo, 2))
            li
                +card_img(suits[0], cards[0])
                .card-placeholder.enabled(style = 'display: none;')
                    .plus-content: span.glyphicon.glyphicon-plus
                b.low-range
            li
                +card_img(suits[0], cards[0])(style='display: none;')
                .card-placeholder.enabled
                    .plus-content: span.glyphicon.glyphicon-plus
                b.high-range

            span.result.label.label-success

        .player-label
            span.label.label-primary Player #{playerNo}


head
  title ProPokerTools2 :3


   //- remote scripts
  script(src='//code.jquery.com/jquery-2.1.3.min.js')
  script(src='https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.2/underscore-min.js')

  link(rel='stylesheet', href='https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/themes/smoothness/jquery-ui.css')
  script(src='https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/jquery-ui.min.js')

  link(rel='stylesheet', type='text/css', href='css/vendor/normalize/normalize.css')
  link(rel='stylesheet', href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css')
  script(src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js')

  link(rel='stylesheet', type='text/css', href='css/index.css')
  link(rel='stylesheet', type='text/css', href='css/vendor/liteAccordion/liteaccordion.css')

body
    #content.container
            h1 ProPokerTools2
            .row
                #table.col-md-8
                    - for (var i = 1; i <= 6; ++i)
                        +player_space(i)

                    ul#table-cards
                        li#flop.table-card-set(tabIndex=7)
                            ul
                                - for (var i = 0; i < 3; ++i)
                                    li.table-card.enabled(id="f#{i}")&attributes(show_modal_attributes('flop', 3))
                                        .plus-content: span.glyphicon.glyphicon-plus

                        li#turn.table-card-set(tabIndex=8)
                            #t1.button.table-card&attributes(show_modal_attributes('turn', 1))
                                .plus-content: span.glyphicon.glyphicon-plus

                        li#river.table-card-set(tabIndex=9)
                            #r1.button.table-card&attributes(show_modal_attributes('river', 1))
                                .plus-content: span.glyphicon.glyphicon-plus

                #sidebar.col-md-4
                    h2.blue-gradient Output
                    #output-tables
                        script(type="template" id="outputTemplate").
                            <div class="simulateResult">
                                <h5>Simulation: <span style='float: right'><%= timeStr %></span></h5>
                                <div class="row topRow">
                                    <div class="col-md-6">
                                        <p> Table: &nbsp;
                                        <% _.each(result.board.flop, function (c) { %>
                                        <span class="<%= tag2ColorClass(c) %>">
                                            <%= c[0].toUpperCase() + suit2Unicode[c[1]] %>
                                        </span>
                                        <% }); %>
                                        <% if (result.board.turn) { %>
                                            &nbsp;
                                            <span class="<%= tag2ColorClass(result.board.turn) %>">
                                                <%= result.board.turn[0].toUpperCase() + suit2Unicode[result.board.turn[1]] %>
                                            </span>

                                            <% if (result.board.river) { %>
                                                &nbsp;
                                                <span class="<%= tag2ColorClass(result.board.river) %>">
                                                    <%= result.board.river[0].toUpperCase() + suit2Unicode[result.board.river[1]] %>
                                                </span>
                                            <% } %>
                                        <% } %>

                                        </p>
                                    </div>
                                    <div class="col-md-4 col-md-offset-2">
                                        <button class="resetBtn btn btn-warning"
                                                data-value='<%= JSON.stringify(submitData) %>'>
                                            Replay
                                        </button>
                                    </div>
                                </div>
                                <div class="row">
                                    <table class="outputTable table">
                                        <tr>
                                            <th>Player</th>
                                            <th>Hand</th>
                                            <th>Equity</th>
                                            <th>Wins </th>
                                            <th>Ties </th>
                                        </tr>
                                        <% _.each(result.hands, function (player, i) { %>
                                            <tr class="<%= (player.winner ? "success" : "") %>" >
                                                <td class="playerId"><%= i+1 %></td>
                                                <td class="cards">
                                                    <% _.each(player.hand, function (c) { %>
                                                        <span class="<%= tag2ColorClass(c) %>">
                                                            <%= c[0].toUpperCase() + suit2Unicode[c[1]] %>
                                                        </span>
                                                    <% }); %>
                                                </td>
                                                <td><%= player.equity %>%</td>
                                                <td><%= player.wins %></td>
                                                <td><%= player.ties %></td>
                                            </tr>
                                        <% }); %>
                                    </table>
                                </div>
                            <div>

            #footer.row
                .controls
                    button#simulate.btn.btn-lg.btn-success(tabIndex=10) Simulate
                    button#reset.btn.btn-lg.btn-danger(tabIndex=11) Reset

        include ./modal.jade

    //- local scripts:
    script(src='js/bloodhound.js')
    script(src='js/liteAccordion/liteaccordion.jquery.min.js')

    //- Application scripts
    script(src='js/model.js')
    script(src='js/gameAction.js')
    script(src='js/simulate.js')
    script(src='js/cardPicker.js')
    script(src='js/index.js')
